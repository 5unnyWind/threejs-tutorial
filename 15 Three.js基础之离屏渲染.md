# 15 Three.js基础之离屏渲染

## Render Targets(离屏渲染)简介

#### 名词解释：Render Targets

**从字面上直接翻译，“Render Targets” 应该翻译为 “渲染目标”。**

**从实际作用上翻译，”Render Targets“ 应该翻译为 ”离屏渲染“。**

> 国内绝大多数 Three.js 教程都把 Render Targets 翻译为 离屏渲染。



#### 离屏渲染概念解释

首先，我们先说一下 普通的“渲染”。

之前示例中我们使用的渲染器都是 WebGLRenderer。我们创建的渲染器实例 renderer 会根据 场景(含场景中的物体)、灯光 来将视觉结果渲染到网页中。

此时的 渲染 就是普通的渲染，渲染结果直接出现在网页中。



**那什么又是离屏渲染？**

答：渲染器会渲染场景，但是不会吧渲染结果直接呈现在网页中，而是把渲染结果保存到 GPU 内部中。

此时 暂存到 GPU 中的渲染结果(图片)，可以被当做一种纹理(texture)，使用到其他物体中。

离屏渲染 和 正常渲染 整个计算过程完全相同，不同的地方在于 离屏渲染 的结果是保存在 GPU 内存中，而非直接显示在网页中。



#### 离屏渲染的种类

在 Three.js 中，一共有 3 种离屏渲染类型。

| 离屏渲染类型                 | 名称及解释                 |
| ---------------------------- | -------------------------- |
| WebGLMultisampleRenderTarget | WebGL 2 对应的离屏渲染     |
| WebGLRenderTarget            | WebGLRender 对应的离屏渲染 |
| WebGLCubeRenderTarget        | CubeCamera 对应的离屏渲染  |



#### 离屏渲染的用途

假设有这样一个场景：场景中有 3 个不同颜色、不停转动的立方体。

我们之前示例中会使用 WebGLRenderer ，把这个场景画面内容渲染到网页中，这属于正常的渲染。

若我们现在改变需求，我们希望修改成：

1. 场景中有一面镜子
2. 在镜子中显示出 3 个不同颜色、不同旋转的立方体
3. 场景本身当中，是看不见这 3 个立方体的

为了实现这个需求，我们此时就需要用到 离屏渲染。

具体做法是：

1. 创建一个子场景，该子场景中 有 3 个不同颜色、不停旋转的立方体

2. 创建一个离屏渲染实例，该离屏渲染实例针对这个子场景进行渲染，得到一个离屏渲染结果(图像纹理)

   > 注意：由于是离屏渲染，只是将 3 个立方体渲染出的视觉效果保存到 GPU 内存中，网页中并不会显示出离屏渲染结果

3. 创建一个总场景、一个渲染器，一面镜子

4. 将离屏渲染结果作为一个纹理，作用在镜子面上

5. 通过总场景中的渲染器，将渲染结果显示在网页中

   > 至此，完成我们的目标。



## 离屏渲染示例：HelloRenderTarget

#### 示例目标：

1. 场景中有一个旋转的立方体
2. 该立方体的 6 个面中 分别显示 也在旋转的 3 个立方体 



